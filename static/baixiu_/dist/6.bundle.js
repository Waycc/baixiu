(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{101:function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"page-title"},[e("h1",[t._v("所有文章")]),t._v(" "),e("router-link",{staticClass:"btn btn-primary btn-xs",attrs:{to:"/post-add"}},[t._v("写文章")])],1),t._v(" "),e("div",{staticClass:"page-action"},[e("a",{staticClass:"btn btn-danger btn-sm",attrs:{href:"javascript:;"},on:{click:t.batchDelete}},[t._v("批量删除")]),t._v(" "),e("form",{staticClass:"form-inline"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.postCategory,expression:"postCategory"}],staticClass:"form-control input-sm",attrs:{name:""},on:{change:function(s){var e=Array.prototype.filter.call(s.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.postCategory=s.target.multiple?e:e[0]}}},[e("option",{attrs:{value:"all"}},[t._v("所有分类")]),t._v(" "),t._l(t.categoriesList,function(s){return e("option",{key:s.id,domProps:{value:s.id}},[t._v(t._s(s.name))])})],2),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.postStatus,expression:"postStatus"}],staticClass:"form-control input-sm",attrs:{name:""},on:{change:function(s){var e=Array.prototype.filter.call(s.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.postStatus=s.target.multiple?e:e[0]}}},[e("option",{attrs:{value:"all"}},[t._v("所有状态")]),t._v(" "),e("option",{attrs:{value:"drafted"}},[t._v("草稿")]),t._v(" "),e("option",{attrs:{value:"published"}},[t._v("已发布")])]),t._v(" "),e("button",{staticClass:"btn btn-default btn-sm",on:{click:function(s){return s.preventDefault(),t.postFilter(s)}}},[t._v("筛选")])]),t._v(" "),e("el-pagination",{staticClass:"pull-right",attrs:{background:"",layout:"prev, pager, next, sizes","page-sizes":[1,20,50,100,150],"page-size":t.pageSize,total:t.postTotal},on:{"size-change":t.sizeChange,"current-change":t.currentPageChange}})],1),t._v(" "),e("table",{staticClass:"table table-striped table-bordered table-hover"},[e("thead",[e("tr",[e("th",{staticClass:"text-center",attrs:{width:"40"}},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.postList.length===t.postIds.length&&t.postIds.length},on:{click:t.checkAll}})]),t._v(" "),e("th",[t._v("标题")]),t._v(" "),e("th",[t._v("分类")]),t._v(" "),e("th",{staticClass:"text-center"},[t._v("发表时间")]),t._v(" "),e("th",{staticClass:"text-center"},[t._v("状态")]),t._v(" "),e("th",{staticClass:"text-center",attrs:{width:"100"}},[t._v("操作")])])]),t._v(" "),e("tbody",t._l(t.postList,function(s){return e("tr",{key:s.id},[e("td",{staticClass:"text-center"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.postIds.includes(s.id)},on:{click:function(e){return e.stopPropagation(),t.handleCheck(s.id)}}})]),t._v(" "),e("td",[t._v(t._s(s.title))]),t._v(" "),e("td",[t._v(t._s(s.category&&s.category.name||"未分类"))]),t._v(" "),e("td",{staticClass:"text-center"},[t._v(t._s(s.created))]),t._v(" "),e("td",{staticClass:"text-center"},[t._v(t._s(t.statusMap[s.status]))]),t._v(" "),e("td",{staticClass:"text-center"},[e("a",{staticClass:"btn btn-info btn-xs",attrs:{href:"javascript:;"},on:{click:function(e){return t.updatePost(s.id)}}},[t._v("编辑")]),t._v(" "),e("a",{staticClass:"btn btn-danger btn-xs",attrs:{href:"javascript:;"},on:{click:function(e){return e.stopPropagation(),t.deletePost(s.id)}}},[t._v("删除")])])])}),0)])])])};a._withStripped=!0;var n=e(5),o={name:"profile",data:function(){return{postList:[],statusMap:{published:"已发布",drafted:"草稿"},postCategory:"all",postStatus:"all",postIds:[],currentPage:1,pageSize:20,postTotal:0,categoriesList:[]}},computed:{postListParams:function(){return{page:this.currentPage,pageSize:this.pageSize,category_id:this.postCategory,status:this.postStatus}}},methods:{updatePost:function(t){this.$router.push({name:"postAdd",params:{postId:t}})},postFilter:function(){this.getPost(),this.postIds=[]},checkAll:function(){var t=this;this.postList.length!==this.postIds.length?this.postList.map(function(s){t.postIds.includes(s.id)||t.postIds.push(s.id)}):this.postIds=[]},handleCheck:function(t){var s=this.postIds.indexOf(t);s>=0?this.postIds.splice(s,1):this.postIds.push(t)},sizeChange:function(t){this.pageSize=t,this.getPost()},currentPageChange:function(t){this.currentPage=t,this.getPost()},getPost:function(){var t=this;return n.a.getPost(this.postListParams).then(function(s){t.postList=s.data.data,t.postTotal=s.data.count})},getCategory:function(){var t=this;n.a.getCategory().then(function(s){s.data.status?t.categoriesList=s.data.data:alert(s.data.message||"获取类别失败")})},deletePost:function(t){var s=this;confirm("是否删除")&&n.a.deletePost({postId:t}).then(function(t){t.data.status&&(alert("删除成功"),s.getPost())})},batchDelete:function(){var t=this;0!==this.postIds.length?confirm("是否批量删除已选中项？")&&(n.a.batchDeletePost({postIds:this.postIds}).then(function(s){alert("批量删除成功"),t.getPost()}),console.log(this.postIds)):alert("请先选择删除项")}},created:function(){this.getPost(),this.getCategory()}},i=e(2),r=Object(i.a)(o,a,[],!1,null,"207bb31a",null);r.options.__file="src/components/posts.vue";s.default=r.exports}}]);